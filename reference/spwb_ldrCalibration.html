<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calibration of root distribution — spwb_ldrCalibration • medfateutils</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calibration of root distribution — spwb_ldrCalibration"><meta name="description" content="The function spwb_ldrCalibration calibrates the species root
distribution within spwb, given the arguments x, meteo,
psi_crit, obs and calibVar. This calibration
is based on reference measured values. These reference measured values can be
Soil water content, Total tranpiration or Transpiration by
cohort. Return the calibrated root distribution for each tree species (no
shrub calibration is done), expressed as parameters of the function
root_ldrDistribution."><meta property="og:description" content="The function spwb_ldrCalibration calibrates the species root
distribution within spwb, given the arguments x, meteo,
psi_crit, obs and calibVar. This calibration
is based on reference measured values. These reference measured values can be
Soil water content, Total tranpiration or Transpiration by
cohort. Return the calibrated root distribution for each tree species (no
shrub calibration is done), expressed as parameters of the function
root_ldrDistribution."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">medfateutils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/medfateutils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calibration of root distribution</h1>
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/medfateutils/blob/HEAD/R/spwb_ldrCalibration.R" class="external-link"><code>R/spwb_ldrCalibration.R</code></a></small>
      <div class="d-none name"><code>spwb_ldrCalibration.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>spwb_ldrCalibration</code> calibrates the species root
distribution within <code><a href="https://emf-creaf.github.io/medfate/reference/spwb.html" class="external-link">spwb</a></code>, given the arguments <code>x</code>, <code>meteo</code>,
<code>psi_crit</code>, <code>obs</code> and <code>calibVar</code>. This calibration
is based on reference measured values. These reference measured values can be
<code>Soil water content</code>, <code>Total tranpiration</code> or <code>Transpiration by
cohort</code>. Return the calibrated root distribution for each tree species (no
shrub calibration is done), expressed as parameters of the function
<code>root_ldrDistribution</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spwb_ldrCalibration</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">meteo</span>,</span>
<span>  <span class="va">calibVar</span>,</span>
<span>  <span class="va">obs</span>,</span>
<span>  RZmin <span class="op">=</span> <span class="fl">301</span>,</span>
<span>  RZmax <span class="op">=</span> <span class="fl">4000</span>,</span>
<span>  V1min <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  V1max <span class="op">=</span> <span class="fl">0.94</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  heat_stop <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  transformation <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code><a href="https://emf-creaf.github.io/medfate/reference/modelInput.html" class="external-link">spwbInput</a></code>.</p></dd>


<dt id="arg-meteo">meteo<a class="anchor" aria-label="anchor" href="#arg-meteo"></a></dt>
<dd><p>A data frame with daily meteorological data series.</p></dd>


<dt id="arg-calibvar">calibVar<a class="anchor" aria-label="anchor" href="#arg-calibvar"></a></dt>
<dd><p>A character string indicating the calibration variable to be used.
It can be one of the following: <code>SWC</code>, <code>Eplanttot</code>
or <code>Cohorts</code>.</p></dd>


<dt id="arg-obs">obs<a class="anchor" aria-label="anchor" href="#arg-obs"></a></dt>
<dd><p>Measured calibration variable. Depending on the value of <code>calibVar</code>
it can be a numeric vector with the measured SWC values (if
<code>calibVar = "SWC"</code>), or a data frame with the first column
containing the measured total transpiration (named <code>Eplanttot</code>) and
the following columns containing the cohorts transpiration.</p></dd>


<dt id="arg-rzmin">RZmin<a class="anchor" aria-label="anchor" href="#arg-rzmin"></a></dt>
<dd><p>The minimum value of RZ (the rooting depth) to be explored (in mm)</p></dd>


<dt id="arg-rzmax">RZmax<a class="anchor" aria-label="anchor" href="#arg-rzmax"></a></dt>
<dd><p>The maximum value of RZ (the rooting depth) to be explored (in mm)</p></dd>


<dt id="arg-v-min">V1min<a class="anchor" aria-label="anchor" href="#arg-v-min"></a></dt>
<dd><p>The minimum value of V1 (the root proportion in the first soil layer) to be explored</p></dd>


<dt id="arg-v-max">V1max<a class="anchor" aria-label="anchor" href="#arg-v-max"></a></dt>
<dd><p>The maximum value of V1 (the root proportion in the first soil layer) to be explored</p></dd>


<dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p>An integer defining the number of values to obtain by discretization of the root parameters RZ and V1. The number of parameter combinations and therefore the computation cost increases increase with the square of resolution</p></dd>


<dt id="arg-heat-stop">heat_stop<a class="anchor" aria-label="anchor" href="#arg-heat-stop"></a></dt>
<dd><p>An integer defining the number of days during to discard from the calculation of the optimal root distribution. Usefull if the soil water content initialization is not certain</p></dd>


<dt id="arg-transformation">transformation<a class="anchor" aria-label="anchor" href="#arg-transformation"></a></dt>
<dd><p>Function to modify the size of Z intervals to be explored (by default, bins are equal).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical value. Print the internal messages of the function?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns a data frame containing the species index used in medfate,
calibrated values for Z50, Z95 and V1 and the MAE value for that combination.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function performs three different kinds of calibration, selecting those
root distribution parameters that minimize the MAE between the predicted values
and the measured values provided in <code>obs</code> argument. If <code>calibVar = "SWC"</code> different
V1 values are tested running <code><a href="https://emf-creaf.github.io/medfate/reference/spwb.html" class="external-link">spwb</a></code> maintaining the total soil depth
provided in <code>x</code> and assuming that value is also the depth containing 95 percent of the
roots. If <code>calibVar = "Eplanttot"</code> or <code>calibVar = 'Cohorts'</code> different
combinations of RZ and V1 values are tested for each tree cohort and the root
paramters are selected based on the MAE between the total transpiration or the
cohort transpiration.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="spwb_ldrOptimization.html">spwb_ldrOptimization</a></code> for when no measured data is available,
 <code><a href="https://emf-creaf.github.io/medfate/reference/spwb.html" class="external-link">spwb</a></code>, <code><a href="https://emf-creaf.github.io/medfate/reference/soil.html" class="external-link">soil</a></code>, <code>root_ldrDistribution</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Víctor Granda, CREAF</p>
<p>Antoine Cabon, CTFC-CREAF</p>
<p>Miquel De Cáceres Ainsa, CREAF</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Víctor Granda, Adriana Tovar, Antoine Cabon, Nicolas Martin-StPaul, Arsène Druel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

